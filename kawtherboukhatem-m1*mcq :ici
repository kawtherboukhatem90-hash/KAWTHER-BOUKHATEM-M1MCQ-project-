#Boukhatem kawther ,m1 microbiologie et controle de qualite,06/12/2025
#Bouchenafa Hadil
#Boudjema sanaa
#Ghennou nada
#Gheraz meryem ghizlene 


import pandas as pd 

# Donneès:sèquences ADN ,longueur,pourcentage de GC 
data ={
     "sèquences":["ATGCGTACGTA", "GCTAGCTAGGCC", "ATGCGCGTAAGT", "TACGATCGTA", "ATGAAAGGCTT", "CGTACGTAGC", "TTAACCGGAT"],
     "longueur":[12 , 12 , 12 , 10 , 11 , 10 , 10 ],
     "pourcentage_GC":[50 , 66.67 , 58.33 , 40 , 45.45 , 60 , 60 ]
}
# crèation d`un DataFrame (tableau pandas)
df = pd.DataFrame(data)
print("******************crèation et affichage***************")

#affichage du tableau
print("tableau des sèquences ADN :")
print(df)

 #opèrations sur les tableaux :
print("****************opèrations***********")
#1) sèlectionner la colonne "longueur"
longueur = df ["longueur"]
print(longueur)


#Étape 3: Filtrer les séquences ayant une longueur> 10 
df_filtre = df[df["longueur"] > 10]

print("séquences avec longueur> 10:")
print(df_filtre)

#Étape 4: calculer la moyenne du pourcentage_GC avec 3 chiffre aprés la virgule
gc_moyenne = round(df["pourcentage_GC"].mean(), 3)

print("La moyenne du pourcentage_Gc est :",gc_moyenne)


#Etape 5: Ajouté une colonne "catégorie GC " :

#Fonction qui retourne la catégorie GC
def catégorie_gc(pct):
    if pct > 55:
        return "Riche"
    elif 45 <= pct <= 55:
        return "Moyen"
    else:
        return "faible"
        
# Application de la fonction sur la colonne pourcentage_GC
df["catégorie GC"] = df["pourcentage_GC"].apply(catégorie_gc)

#question06:nombre de g dans chaque sèequence 

def compter_G (sequence):
    return sequence.count("G")
    
df["nb_G"] = df ["sèquences"].apply(compter_G)
print (df)


#Etape 7:Calcule de l'ecart-type

ecart_gc=df["pourcentage_GC"].std()
ecart_long=df["longueur"].std()

print("\nEcart_type du pourcentage_GC:",ecart_gc)
print("ecart_type du la longueur:",ecart_long)


#Etape 8:Sauvegard CSV

df.to_csv("resultat_final.csv",index=False)
print("\nLe fichier Csv 'resultat_final.csv' a été généré")
